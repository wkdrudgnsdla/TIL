
### 사용될 키워드

- **동시성**
    - 멀티태스킹: 여러 작업을 하나의 주체가 동시에 진행
    - 실행 주체: 궁극적인 실행 주체가 하나이고, 싱글 코어 및 싱글 스레드에서 발생함.
    - 문제점: 잦은 문맥교환으로 인한 오버헤드 발생
        - 오버헤드?
            
             **어떤 처리를 하기 위해 들어가는 간접적인 처리 시간 · 메모리 등**을 말한다.
            
- **병렬성**
    - 태스크(Task): 여러 주체가 동시에 각자의 작업을 수행
    - 실행 주체: 싱글 및 멀티 코어, 멀티 스레드 등 다양한 환경에서 발생
- 락(Lock)
    - 공유 자원에 대한 동시 접근을 제어하기 위해서 사용되는 메커니즘
- **공유 자원에 동시 접근 문제점**
    - 경쟁상태:여러 스레드가 동시에 공유 자원을 수정하려고 할 때 발생
    - 일관성 문제:스레드 간의 작업이 동시에 수행될 때 데이터 일관성이 깨질 수 있음
    - 결과값의 불일치: 여러 스레드가 동시에 자원을 수정할 때 예상치 못한 결과가 발생할 수 있음

### 동시성이란?

- 동시성은 동시에 두가지 이상의 일을 하는 것
- 동시에 실행되는 것 같이 보인다

동시성은 실행하는 궁극적인 주체(코어 혹은 스레드)가 하나인데

두가지 이상의 일을 수행하는 것이다

하지만 컴퓨터가 처리하는 속도가 사람이 인지하기 힘들정도로 빠르기 때문에

동시에 실행되는것 처럼 보인다.

### 병렬성이란?

- 병렬성은 동시에 두가지 이상의 일을 하는것
- 실제로 동시에 여러 작업이 처리되는것

병렬성은 동시성과 반대로 실제로 해당 태스크를 수행하는 주체가 다수인 것이다.

대부분의 OS관련 책에는 싱글 코어와 멀티 코어의 차이로 설명을 하는데,

병렬성은 여기서 멀티코어에서 각 태스크 하나 당 하나의 코어가 작업을 진행하는 것을 에시로 든다.

### 그림으로 보는 동시성과 병렬성

![image.png](image%208.png)

위의 사진을 보면 동시성과 병렬성의 차이를 한눈에 볼 수 있다

여기서 눈여겨 볼 부분은 동시성엔 Context Switch가 발생하게 되는데

> Context Switch(문맥교환)는 하나의 프로세스가 CPU를 사용중인 상태에서 
다른 프로세스가 CPU를 사용하도록 하기 위하여, 이전의 프로세스의 상태를 보관하고
새로운 프로세스의 상태를 적재하는 작업을 말한다.
한 프로세스의 문맥은 그 프로세스의 PCB(프로세스 제어 블록)에 기록되어있다.
> 

이러한 Context Switch가 빈번하게 발생하면 많은 오버헤드가 생길 수 있다

만약 하나의 코어에 하나의 태스크만 실행시킨다면 Context Switch가 발생하지 않을 것이다.

하지만 사진에서는 2개 이상의 태스크를 실행시킬때의 차이를 보여주고 있다.

![image.png](image%209.png)

### 병렬성이 동시성보다 좋을까?

싱글스레드보다 멀티 스레드가 작업을 실행하는 주체가 많기 때문에

이점이 많다고 생각할 수 있지만 고려해야할 부분이 상당히 많다

- 멀티 스레드 환경에서 공유대는 자원에 대한 접근으로 인한 문제
    - 공유된 자원에 동시 접근에 대한 문제
        - 경쟁상태
        - 일관성 문제
        - 스레드끼리 각자 공유 자원을 수정 시 원하는 결과값이 안나올 수 있다
- 멀티 스레드 관리에 관한 문제
    - 하나의 스레드에 작업이 과도히 몰리는 문제
    - 멀티 스레드를 사용하지만 놀고있는 스레드가 많은 경우의 문제

성능적 이점과 같은 부분 때문에 병렬적 프로그래밍을  도입하다가 위와같은 치명적인 문제가 발생할 수 있다.

공유 자원의 접근을 해결하기 위해 Lock을 거는 방법이 있지만, Lock을 무분별하게 걸게되면 

지연이 생기는 문제가 발생할 수 있다.

Lock을 사용하여 공유 자원에 대한 접근을 하나의 스레드만 접근하도록 보장하지만

그만큼 다른 스레드가 대기시간이 길어지게 되면 생기게 되는 문제이다.